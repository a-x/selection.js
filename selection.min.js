(function(){var f,c,h,k,l=Array.prototype.slice;f={isPreceding:function(a,b){return b.compareDocumentPosition(a)&2},isText:function(a){return(a!=null?a.nodeType:void 0)===3},getChildIndex:function(a){var b;for(b=0;a=a.previousSibling;)b++;return b}};this.Selection=c=function(){function a(a){this.win=a}a.prototype.hasSelection=function(){return a.hasSelection(this.win)};a.prototype.getOrigin=function(){return a.getOrigin(this.win)};a.prototype.getFocus=function(){return a.getFocus(this.win)};a.prototype.getStart=
function(){return a.getStart(this.win)};a.prototype.getEnd=function(){return a.getEnd(this.win)};a.prototype.setSelection=function(){var b;b=1<=arguments.length?l.call(arguments,0):[];return a.setSelection.apply(a,[this.win].concat(l.call(b)))};a.prototype.clearSelection=function(){return a.clearSelection(this.win)};return a}();this.getSelection?(c.supported=!0,c.hasSelection=function(a){var b;return(b=a.getSelection())&&b.focusNode!=null&&b.anchorNode!=null},c.getOrigin=function(a){var b;return!((b=
a.getSelection())&&b.anchorNode!=null)?null:[b.anchorNode,b.anchorOffset]},c.getFocus=function(a){var b;return!((b=a.getSelection())&&b.focusNode!=null)?null:[b.focusNode,b.focusOffset]},c.getStart=function(a){var b,e,d;if(!c.hasSelection(a))return null;e=c.getOrigin(a);b=e[0];e=e[1];d=c.getFocus(a);a=d[0];d=d[1];return f.isPreceding(b,a)||b===a&&e<d?[b,e]:[a,d]},c.getEnd=function(a){var b,e,d;if(!c.hasSelection(a))return null;e=c.getOrigin(a);b=e[0];e=e[1];d=c.getFocus(a);a=d[0];d=d[1];return f.isPreceding(b,
a)||b===a&&e<d?[a,d]:[b,e]},c.setSelection=function(a,b,e,d,c){var g,f,i;d==null&&(d=b);c==null&&(c=e);g=a.document.createRange();g.setStart(b,e);g.setEnd(d,c);try{(f=a.getSelection())!=null&&f.removeAllRanges()}catch(h){}return(i=a.getSelection())!=null?i.addRange(g):void 0},c.clearSelection=function(a){var b;try{return(b=a.getSelection())!=null?b.removeAllRanges():void 0}catch(c){}}):this.document.selection?(h=function(a,b,c){var d,j,a=a.createElement("a");d=b.duplicate();d.collapse(c);for(j=d.parentElement();;)if(j.insertBefore(a,
a.previousSibling),d.moveToElementText(a),!(d.compareEndPoints(c?"StartToStart":"StartToEnd",b)>0&&a.previousSibling!=null))break;d.compareEndPoints(c?"StartToStart":"StartToEnd",b)===-1&&a.nextSibling?(d.setEndPoint(c?"EndToStart":"EndToEnd",b),b=a.nextSibling,c=d.text.length):(b=a.parentNode,c=f.getChildIndex(a));a.parentNode.removeChild(a);return[b,c]},k=function(a,b,c,d,j){var g,h,i;i=0;g=f.isText(d)?d:d.childNodes[j];h=f.isText(d)?d.parentNode:d;f.isText(d)&&(i=j);d=a.createElement("a");h.insertBefore(d,
g||null);a=a.body.createTextRange();a.moveToElementText(d);d.parentNode.removeChild(d);b.setEndPoint(c?"StartToStart":"EndToEnd",a);return b[c?"moveStart":"moveEnd"]("character",i)},c.supported=!0,c.hasSelection=function(a){var b;a.focus();return!a.document.selection?!1:(b=a.document.selection.createRange())&&b.parentElement().document===a.document},c.getStart=function(a){var b;a.focus();if(!c.hasSelection(a))return null;b=a.document.selection.createRange();return h(a.document,b,!0)},c.getEnd=function(a){var b;
a.focus();if(!c.hasSelection(a))return null;b=a.document.selection.createRange();return h(a.document,b,!1)},c.getOrigin=function(a){return c.getStart(a)},c.getFocus=function(a){return c.getEnd(a)},c.setSelection=function(a,b,c,d,f){var g;d==null&&(d=b);f==null&&(f=c);g=a.document.body.createTextRange();k(a.document,g,!1,d,f);k(a.document,g,!0,b,c);return g.select()},c.clearSelection=function(a){return a.document.selection.empty()}):c.supported=!1}).call(this);
