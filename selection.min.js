(function(){var f,d,k,l,m=Array.prototype.slice;f={isPreceding:function(a,b){return b.compareDocumentPosition(a)&2},contains:function(a,b){return null!=a.compareDocumentPosition?a.compareDocumentPosition(b)&16:a.contains(b)},isCursorPreceding:function(a,b,e,c){return a===e?b<=c:f.isText(a)&&f.isText(e)?f.isPreceding(a,e):f.isText(a)&&!f.isText(e)?!f.isCursorPreceding(e,c,a,b):!f.contains(a,e)?f.isPreceding(a,e):a.childNodes.length<=b?!1:a.childNodes[b]===e?0<=c:f.isPreceding(a.childNodes[b],e)},isText:function(a){return 3===
(null!=a?a.nodeType:void 0)},getChildIndex:function(a){var b;for(b=0;a=a.previousSibling;)b++;return b}};this.Selection=d=function(){function a(a){this.win=a}a.prototype.hasSelection=function(){return a.hasSelection(this.win)};a.prototype.getOrigin=function(){return a.getOrigin(this.win)};a.prototype.getFocus=function(){return a.getFocus(this.win)};a.prototype.getStart=function(){return a.getStart(this.win)};a.prototype.getEnd=function(){return a.getEnd(this.win)};a.prototype.setSelection=function(){var b;
b=1<=arguments.length?m.call(arguments,0):[];return a.setSelection.apply(a,[this.win].concat(m.call(b)))};a.prototype.clearSelection=function(){return a.clearSelection(this.win)};return a}();this.getSelection?(d.supported=!0,d.hasSelection=function(a){var b;return(b=a.getSelection())&&null!=b.focusNode&&null!=b.anchorNode},d.getOrigin=function(a){var b;return!((b=a.getSelection())&&null!=b.anchorNode)?null:[b.anchorNode,b.anchorOffset]},d.getFocus=function(a){var b;return!((b=a.getSelection())&&null!=
b.focusNode)?null:[b.focusNode,b.focusOffset]},d.getStart=function(a){var b,e,c,g;if(!d.hasSelection(a))return null;c=d.getOrigin(a);b=c[0];e=c[1];g=d.getFocus(a);a=g[0];c=g[1];return f.isCursorPreceding(b,e,a,c)?[b,e]:[a,c]},d.getEnd=function(a){var b,e,c,g;if(!d.hasSelection(a))return null;c=d.getOrigin(a);b=c[0];e=c[1];g=d.getFocus(a);a=g[0];c=g[1];return f.isCursorPreceding(b,e,a,c)?[a,c]:[b,e]},d.setSelection=function(a,b,e,c,d){var f,j,i;null==c&&(c=b);null==d&&(d=e);f=a.document.createRange();
f.setStart(b,e);f.setEnd(c,d);try{null!=(j=a.getSelection())&&j.removeAllRanges()}catch(k){}return null!=(i=a.getSelection())?i.addRange(f):void 0},d.clearSelection=function(a){var b;try{return null!=(b=a.getSelection())?b.removeAllRanges():void 0}catch(e){}}):this.document.selection?(k=function(a,b,e){var c,d,a=a.createElement("a");c=b.duplicate();c.collapse(e);for(d=c.parentElement();!(d.insertBefore(a,a.previousSibling),c.moveToElementText(a),!(0<c.compareEndPoints(e?"StartToStart":"StartToEnd",
b)&&null!=a.previousSibling)););-1===c.compareEndPoints(e?"StartToStart":"StartToEnd",b)&&a.nextSibling?(c.setEndPoint(e?"EndToStart":"EndToEnd",b),b=a.nextSibling,e=c.text.length):(b=a.parentNode,e=f.getChildIndex(a));a.parentNode.removeChild(a);return[b,e]},l=function(a,b,d,c,g){var h,j,i;i=0;h=f.isText(c)?c:c.childNodes[g];j=f.isText(c)?c.parentNode:c;f.isText(c)&&(i=g);c=a.createElement("a");j.insertBefore(c,h||null);a=a.body.createTextRange();a.moveToElementText(c);c.parentNode.removeChild(c);
b.setEndPoint(d?"StartToStart":"EndToEnd",a);return b[d?"moveStart":"moveEnd"]("character",i)},d.supported=!0,d.hasSelection=function(a){var b;a.focus();return!a.document.selection?!1:(b=a.document.selection.createRange())&&b.parentElement().document===a.document},d.getStart=function(a){var b;a.focus();if(!d.hasSelection(a))return null;b=a.document.selection.createRange();return k(a.document,b,!0)},d.getEnd=function(a){var b;a.focus();if(!d.hasSelection(a))return null;b=a.document.selection.createRange();
return k(a.document,b,!1)},d.getOrigin=function(a){return d.getStart(a)},d.getFocus=function(a){return d.getEnd(a)},d.setSelection=function(a,b,d,c,f){var h;null==c&&(c=b);null==f&&(f=d);h=a.document.body.createTextRange();l(a.document,h,!1,c,f);l(a.document,h,!0,b,d);return h.select()},d.clearSelection=function(a){return a.document.selection.empty()}):d.supported=!1}).call(this);